<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Gate Pass - Daraz</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      font-size: 11px;
      margin: 10mm;
      line-height: 1.3;
    }
    .header { display: flex; justify-content: space-between; align-items: flex-start; }
    .logo { height: 20px; }
    table { width: 100%; border-collapse: collapse; margin: 6px 0; }
    th, td { border: 1px solid #000; padding: 4px; vertical-align: top; }
    .footer { text-align: center; font-size: 9px; margin-top: 15px; }
  </style>
</head>
<body>
  <div class="header">
    <img src="<%= logoUrl %>" class="logo" alt="Daraz">
    <h3>GATE PASS#: <%= gatepass._id ? 'BD-IT' + new Date(gatepass.createdAt).toISOString().replace(/[-T:.]/g, '').slice(0,14) : 'N/A' %></h3>
  </div>

  <h2 style="text-align:center;">Daraz Bangladesh Limited</h2>

  <div style="display:flex; justify-content:space-between; margin:8px 0;">
    <div>Dispatch Date: <%= gatepass.date ? new Date(gatepass.date).toLocaleDateString('en-GB') : '____/____/____' %></div>
    <div>Receiving Date: _____________________</div>
  </div>

  <div style="text-align:center; margin:8px 0;">Challan Type: Internal/External</div>

  <!-- Dispatch From / To -->
  <table>
    <tr><th>Dispatch From</th><th>Dispatch To</th></tr>
    <tr>
      <td>
        Name: <%= gatepass.dispatchFrom?.hubName || 'N/A' %><br>
        Zone: <%= gatepass.dispatchFrom?.hubName || 'N/A' %><br>
        Address: <%= gatepass.dispatchFrom?.details || 'N/A' %>
      </td>
      <td>
        Name: <%= gatepass.dispatchTo?.hubName || 'N/A' %><br>
        Zone: <%= gatepass.dispatchTo?.hubName || 'N/A' %><br>
        Address: <%= gatepass.dispatchTo?.details || 'N/A' %>
      </td>
    </tr>
  </table>

  <!-- Sender / Receiver -->
  <table>
    <tr><th>Sender's Details</th><th>Receiver's Details</th></tr>
    <tr>
      <td>
        Name: <%= gatepass.sender?.name || 'N/A' %><br>
        Phone No: <%= gatepass.sender?.phone || 'N/A' %><br>
        Designation: <%= gatepass.sender?.designation || 'N/A' %><br>
        Employee ID: <%= gatepass.sender?.employee_id || 'N/A' %><br>
        Department: <%= gatepass.sender?.department || 'N/A' %>
      </td>
      <td>
        Name: <%= gatepass.receiver?.name || 'N/A' %><br>
        Phone No: <%= gatepass.receiver?.phone || 'N/A' %><br>
        Designation: <%= gatepass.receiver?.designation || 'N/A' %><br>
        Employee ID: <%= gatepass.receiver?.employee_id || 'N/A' %><br>
        Department: <%= gatepass.receiver?.department || 'N/A' %>
      </td>
    </tr>
  </table>

  <!-- Items -->
  <table>
    <tr><th>SL NO</th><th>ITEM DESCRIPTION</th><th>QUANTITY</th><th>UNIT</th></tr>
    <% (gatepass.items || []).forEach((item, i) => { %>
      <tr>
        <td><%= i+1 %></td>
        <td><%= item.name || '' %></td>
        <td><%= item.quantity || '' %></td>
        <td><%= item.unit || '' %></td>
      </tr>
    <% }); %>
    <% for (let i = (gatepass.items?.length || 0); i < 5; i++) { %>
      <tr><td><%= i+1 %></td><td></td><td></td><td></td></tr>
    <% } %>
  </table>

  <!-- Remarks -->
  <div style="margin:8px 0;">
    <div style="font-weight:bold;">Remarks</div>
    <div style="border:1px solid #000; padding:6px; min-height:60px; white-space:pre-wrap;">
      <%= gatepass.remarks || '' %>
    </div>
  </div>

  <!-- Prepared By -->
  <table>
    <tr><th>Prepared By</th></tr>
    <tr>
      <td>
        Name: <%= gatepass.preparedBy?.name || 'N/A' %><br>
        Designation: <%= gatepass.preparedBy?.designation || 'N/A' %><br>
        Employee ID: <%= gatepass.preparedBy?.employee_id || 'N/A' %><br>
        Sign: <%= (gatepass.preparedBy?.name || '').toLowerCase() %>
      </td>
    </tr>
  </table>

  <!-- Signature Blocks -->
  <table style="margin-top:10px;">
    <tr>
      <td style="text-align:center; padding:4px;">PREPARED BY</td>
      <td style="text-align:center; padding:4px;">SECURITY CHECK</td>
      <td style="text-align:center; padding:4px;">RECEIVED BY</td>
    </tr>
    <tr><td colspan="3" style="height:30px; border:1px solid #000;"></td></tr>
    <tr>
      <td style="text-align:center; padding:4px;">BEARER SIGNATURE</td>
      <td colspan="2" style="text-align:center; padding:4px;">AUTHORISED SIGNATURE</td>
    </tr>
  </table>

  <div class="footer">
    Daraz Internal B2 DR-COMP-FRM-GPFRM &nbsp; 28 October, 2024 &nbsp; Version 1.1
  </div>
</body>
</html>